Turbo Assembler	 Version 4.1	    02/11/25 16:15:54	    Page 1
stvale~1.asm



      1				     ;------------------------------------------------------------------------------
      2				     ;			     Asm Task to Valentine's day
      3				     ;			       (c) 2025	Muratov	Artyom
      4				     ;------------------------------------------------------------------------------
      5	0000			     .model tiny
      6	0000			     .code
      7				     org 100h
      8	0100  BE 0156r		     Start:	     lea  si, A			     ; si = ptr	of array of symbols
      9
     10	0103  B4 09				     mov  ah, 09h		     ; color of	frame
     11	0105  B9 0028				     mov  cx, 40		     ; len   of	frame
     12	0108  BA 0005				     mov  dx, 5			     ; high  of	frame
     13	010B  BF 0668				     mov  di, 10 * 80 *	2 + 20 * 2   ; start of	print
     14
     15	010E  E8 0005				     call MakeFrame		     ; make frame
     16
     17	0111  B8 4C00				     mov  ax, 4c00h		     ; DOS Fn 4ch = exit (al)
     18	0114  CD 21				     int  21h
     19				     ;------------------------------------------------------------------------------
     20				     ; MakeFrame     Func to make frame
     21				     ; Entry:	     ah	    - color of frame
     22				     ;		     si	    - ptr   of array of	the symbols for	frame
     23				     ;		     cx	    - len   of frame
     24				     ;		     dx	    - high  of frame
     25				     ;		     di	    - start of print (upper left cornel)
     26				     ; Exit:	     None
     27				     ; Destroy:	     ax, si, cx, dx, di, es
     28				     ;------------------------------------------------------------------------------
     29	0116			     MakeFrame	     proc
     30	0116  57				     push di			     ; save start of print in stack
     31	0117  E8 0036				     call SetEsVideoSeg		     ; di = 0b800h; es = di
     32	011A  5F				     pop  di			     ; back start of print
     33
     34	011B  51				     push cx			     ; save cx in stack
     35	011C  E8 0020				     call MakeStrFrame		     ; make first string of frame
     36	011F  59				     pop  cx			     ; pop cx from stack
     37	0120  83 EA 02				     sub  dx, 2			     ; dx -= 2;	dx = number
     38										     ; of middle strings
     39	0123  81 C7 00A0	     MakeMiddle:     add  di, 80 * 2		     ; di to next string
     40	0127  51				     push cx			     ; save cx
     41	0128  56				     push si			     ; save si
     42	0129  E8 0013				     call MakeStrFrame		     ; make middle string
     43	012C  5E				     pop si			     ; si = &(start symbol of
     44										     ; middle strings)
     45	012D  59				     pop  cx			     ; cx = len	of frame
     46	012E  4A				     dec  dx			     ; dx--;
     47	012F  83 FA 00				     cmp  dx, 0			     ; dx = 0?
     48	0132  75 EF				     jne  MakeMiddle		     ; loop
     49
     50	0134  83 C6 03				     add  si, 3			     ; si = &(start symbol of
     51										     ; end string)
     52	0137  81 C7 00A0			     add  di, 80 * 2		     ; di to next string
     53
     54	013B  E8 0001				     call MakeStrFrame		     ; make end	string of frame
     55
     56	013E  C3				     ret
     57	013F			     MakeFrame	     endp
Turbo Assembler	 Version 4.1	    02/11/25 16:15:54	    Page 2
stvale~1.asm



     58
     59				     ;------------------------------------------------------------------------------
     60				     ; MakeStrFrame  Func to make string of frame
     61				     ; Entry:	     ah	    - color of string
     62				     ;		     si	    - array of symbol for string
     63				     ;		     cx	    - len of string
     64				     ;		     di	    - start of print string
     65				     ;		     es	    - videoseg
     66				     ; Exit:	     None
     67				     ; Destroy:	     ax, cx, si
     68				     ;------------------------------------------------------------------------------
     69	013F			     MakeStrFrame    proc
     70	013F  57				     push di			     ; save di = start of string
     71
     72	0140  AC				     lodsb			     ; ax = first symbol of string
     73										     ; mov al, ds:[si] && inc si
     74	0141  AB				     stosw			     ; mov es:[di], ax && di +=	2
     75
     76	0142  AC				     lodsb			     ; ax = middle symbol of string
     77										     ; mov al, ds:[si] && inc si
     78	0143  83 E9 02				     sub  cx, 2			     ; cx -= 2;	cx = number
     79										     ; of middle symbols
     80	0146  E8 0004				     call PutString		     ; put all middle symbols
     81	0149  AC				     lodsb			     ; ax = end	symbol of string
     82										     ; mov al, ds:[si] && inc si
     83	014A  AB				     stosw			     ; mov es:[di], ax && di +=	2
     84	014B  5F				     pop  di			     ; back di = start of string
     85
     86	014C  C3				     ret
     87	014D			     MakeStrFrame    endp
     88
     89				     ;------------------------------------------------------------------------------
     90				     ; PutString     Func to put string	to consol
     91				     ; Entry:	     ah/ al - color/ symbol
     92				     ;		     cx	    - size of text
     93				     ;		     di	    - start of print
     94				     ;		     es	    - videoseg
     95				     ; Exit:	     None
     96				     ; Destroy:	     es, cx, di
     97				     ;------------------------------------------------------------------------------
     98	014D			     PutString	     proc
     99	014D  F3> AB				     rep stosw			     ; mov es:[di], ax && di +=	2
    100										     ; cx -= 1;	cx = 0?; make loop
    101	014F  C3				     ret
    102	0150			     PutString	     endp
    103
    104				     ;------------------------------------------------------------------------------
    105				     ; SetEsVideoSeg Func to set ptr of	videoseg to es
    106				     ; Entry:	     None
    107				     ; Exit:	     None
    108				     ; Destroy:	     es, di
    109				     ;------------------------------------------------------------------------------
    110	0150			     SetEsVideoSeg   proc
    111	0150  BF B800				     mov  di, 0b800h		     ; VIDEOSEG
    112	0153  8E C7				     mov  es, di		     ; es = videoseg
    113	0155  C3				     ret
    114	0156			     SetEsVideoSeg   endp
Turbo Assembler	 Version 4.1	    02/11/25 16:15:54	    Page 3
stvale~1.asm



    115
    116	0156  C9 CD BB BA 00 BA	C8+  A db 0c9h,	0cdh, 0bbh, 0bah, 00h, 0bah, 0c8h, 0cdh, 0bch
    117	      CD BC
    118										     ; array of	frame's	symbols
    119
    120				     end	     Start
Turbo Assembler	 Version 4.1	    02/11/25 16:15:54	    Page 4
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "02/11/25"
??FILENAME			  Text	 "stvale~1"
??TIME				  Text	 "16:15:54"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 DGROUP
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 STVALE~1
@INTERFACE			  Text	 000H
@MODEL				  Text	 1
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
A				  Byte	 DGROUP:0156
MAKEFRAME			  Near	 DGROUP:0116
MAKEMIDDLE			  Near	 DGROUP:0123
MAKESTRFRAME			  Near	 DGROUP:013F
PUTSTRING			  Near	 DGROUP:014D
SETESVIDEOSEG			  Near	 DGROUP:0150
START				  Near	 DGROUP:0100

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
  _TEXT				  16  015F Word	  Public  CODE
